"0","lmFunction <- function(selectedIndepVariable, selectedDepVariable) {"
"0",""
"0","  # Copy and paste most of previous code chunks"
"0",""
"0","  # Set up formula for running LM"
"0","  formulaLM <- as.formula(paste(selectedDepVariable, selectedIndepVariable, sep = "" ~ ""))"
"0",""
"0","  # Execute"
"0","  fit_bc <- lm(formulaLM, data = bCancer)"
"0",""
"0","  #summary(fit_bc)"
"0",""
"0","  # Text outputs"
"0","  textOfFormula <- paste0(selectedDepVariable, "" = "", "
"0","                          round(fit_bc$coefficients[1], 2), "
"0","                          "" + "", "
"0","                          round(fit_bc$coefficients[2], 2), "
"0","                          ""*"", "
"0","                          names(fit_bc$coefficients[2])"
"0","  )"
"0",""
"0","  message(""The formula to model "", "
"0","          names(fit_bc$coefficients[2]), "
"0","          "" is: "", "
"0","          textOfFormula)"
"0",""
"0","  # Generate a message that says ""The intercept is: ___"""
"0","  message(paste0(""The intercept is: "", round(fit_bc$coefficients[1], 2))) "
"0",""
"0","  # Generate a message that says ""The slope of ___ is ___"""
"0","  message(paste0(""The slope of "","
"0","                 names(fit_bc$coefficients[2]), "
"0","                 "" is "", "
"0","                 round(fit_bc$coefficients[2], 2)))"
"0",""
"0","  # ggplot output"
"0","  ggplot(bCancer, aes(x = .data[[selectedIndepVariable]], y = .data[[selectedDepVariable]])) +"
"0","    geom_point(alpha = 0.4) +"
"0",""
"0","    # the line"
"0","    geom_abline(intercept = fit_bc$coefficients[1],"
"0","                slope = fit_bc$coefficients[2],"
"0","                colour = ""green4"","
"0","                linewidth = 1) +"
"0",""
"0","    # the equation of the line"
"0","    ggtitle(textOfFormula) +"
"0","    theme_classic() +"
"0","    theme(plot.title = element_text(colour = ""green4""))"
"0","}"
"0",""
"0","# Example usage:"
"0","lmFunction(""radius_mean"", ""texture_mean"")"
"2","The formula to model radius_mean is: texture_mean = 13.71 + 0.4*radius_mean
"
"2","The intercept is: 13.71
"
"2","The slope of radius_mean is 0.4
"
